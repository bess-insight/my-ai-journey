å¥½ï¼ŒJasonï¼Œå’±ä»¬ç°åœ¨æ¥ææ¸…æ¥š **NumPy**ï¼Œè¿™æ˜¯ Python åšç§‘å­¦è®¡ç®—ã€æ•°æ®å¤„ç†ã€AI è®­ç»ƒæ—¶çš„åº•å±‚æ­¦å™¨ä¹‹ä¸€ï¼Œå¿…é¡»ç†Ÿã€‚

---

## âœ… ä»€ä¹ˆæ˜¯ NumPyï¼Ÿ

> **NumPyï¼ˆNumerical Pythonï¼‰** æ˜¯ä¸€ä¸ªç”¨äºé«˜æ•ˆæ•°ç»„/çŸ©é˜µè¿ç®—çš„åº“ï¼Œæ˜¯ä½ åé¢åš AI æ•°æ®é¢„å¤„ç†ã€ç‰¹å¾å·¥ç¨‹ã€æ¨¡å‹è®­ç»ƒçš„å¿…å¤‡å·¥å…·ã€‚

---

## âœ… ä¸ºä»€ä¹ˆä¸ç”¨ list è€Œè¦ç”¨ NumPyï¼Ÿ

| ç‰¹æ€§ | Python list | NumPy array           |
| -- | ----------- | --------------------- |
| ç±»å‹ | å¯ä»¥æ··ç±»å‹       | å¿…é¡»åŒç±»å‹ï¼ˆæ›´å¿«ï¼‰             |
| è¿ç®— | ä¸æ”¯æŒæ‰¹é‡åŠ å‡ä¹˜é™¤   | ä¸€è¡Œæå®šå‘é‡/çŸ©é˜µè¿ç®—           |
| æ€§èƒ½ | æ…¢           | å¿«å¾—å¤šï¼ˆCå®ç°ï¼Œåº•å±‚ä¼˜åŒ–ï¼‰         |
| ç”¨é€” | ä¸€èˆ¬æ•°æ®å­˜å‚¨      | ç§‘å­¦è®¡ç®— / æ•°å€¼å¤„ç† / AI æ•°æ®è¾“å…¥ |

---

## ğŸ§± NumPy çš„æ ¸å¿ƒï¼š`ndarray`ï¼ˆN ç»´æ•°ç»„ï¼‰

```python
import numpy as np

a = np.array([1, 2, 3])         # ä¸€ç»´æ•°ç»„
b = np.array([[1, 2], [3, 4]])  # äºŒç»´æ•°ç»„ï¼ˆçŸ©é˜µï¼‰
```

---

## âœ… åŸºæœ¬æ“ä½œï¼šä¸€çœ‹å°±æ‡‚

### åˆ›å»ºæ•°ç»„

```python
np.zeros((2, 3))    # å…¨0æ•°ç»„ï¼Œ2è¡Œ3åˆ—
np.ones((3, 3))     # å…¨1æ•°ç»„
np.eye(3)           # å•ä½çŸ©é˜µ
np.arange(0, 10, 2) # [0, 2, 4, 6, 8]
np.linspace(0, 1, 5)# ç­‰é—´éš”å–ç‚¹ [0. , 0.25, ..., 1.]
```

---

### æ•°ç»„å±æ€§

```python
a.shape     # å½¢çŠ¶ï¼Œæ¯”å¦‚ (2, 3)
a.ndim      # ç»´åº¦ï¼Œæ¯”å¦‚ 2ï¼ˆäºŒç»´ï¼‰
a.size      # å…ƒç´ æ€»æ•°
a.dtype     # å…ƒç´ ç±»å‹ï¼ˆint32ã€float64ç­‰ï¼‰
```

---

### æ•°ç»„ç´¢å¼• & åˆ‡ç‰‡ï¼ˆç±»ä¼¼ listï¼Œä½†æ›´å¼ºï¼‰

```python
a = np.array([[1, 2, 3],
              [4, 5, 6]])

a[0, 1]      # ç¬¬1è¡Œç¬¬2åˆ— â†’ 2
a[:, 0]      # æ‰€æœ‰è¡Œçš„ç¬¬1åˆ— â†’ [1, 4]
a[1, :]      # ç¬¬2è¡Œæ‰€æœ‰åˆ— â†’ [4, 5, 6]
```

---

### æ•°ç»„è¿ç®—ï¼ˆè¿™æ˜¯ NumPy æœ€å¼ºçš„éƒ¨åˆ†ï¼‰

```python
a + 1        # æ‰€æœ‰å…ƒç´  +1
a * 2        # æ‰€æœ‰å…ƒç´  Ã—2
a ** 2       # æ‰€æœ‰å…ƒç´ å¹³æ–¹
```

```python
a + b        # å¯¹åº”ä½ç½®å…ƒç´ ç›¸åŠ 
a.dot(b.T)   # çŸ©é˜µä¹˜æ³•
```

---

### å¸¸è§å‡½æ•°

```python
np.mean(a)           # å¹³å‡å€¼
np.max(a, axis=0)    # æ¯åˆ—æœ€å¤§å€¼
np.min(a, axis=1)    # æ¯è¡Œæœ€å°å€¼
np.sum(a, axis=None) # æ±‚å’Œ
```

---

## âœ… å®æˆ˜ï¼šSoC è¾“å…¥æ•°æ®ç”¨ NumPy å¤„ç†

å‡è®¾ä½ æœ‰ä¸€ä¸ªç”µå‹åºåˆ—ï¼š

```python
v = [3.6, 3.5, 3.4, 3.3, 3.2]
```

è½¬æˆ NumPy æ•°ç»„ï¼š

```python
v_array = np.array(v)

# æ ‡å‡†åŒ–
v_norm = (v_array - np.mean(v_array)) / np.std(v_array)
```

æˆ–è€…æ‹¼æ¥å¤šä¸ªé€šé“æ•°æ®ï¼š

```python
voltage = np.array([3.7, 3.6, 3.5])
current = np.array([1.0, 0.8, 0.6])
temp = np.array([25.0, 25.2, 25.1])

x = np.stack([voltage, current, temp], axis=1)  # shape: (3, 3)
```

è¿™ä¸€æ­¥ä½ åœ¨è·‘ LSTM æ—¶è‚¯å®šä¼šç¢°åˆ°ã€‚

---

## âœ… å°ç»“ä¸€å¼ è¡¨

| åŠŸèƒ½   | NumPy æ“ä½œ                          |
| ---- | --------------------------------- |
| åˆ›å»ºæ•°ç»„ | `np.array, np.zeros, np.ones`     |
| å±æ€§   | `.shape, .dtype, .ndim`           |
| ç´¢å¼•åˆ‡ç‰‡ | `a[0, :], a[:, 1]`                |
| è¿ç®—   | `a+1, a*b, a.dot(b)`              |
| ç»Ÿè®¡å‡½æ•° | `np.mean, np.sum, np.max(axis=0)` |
| æ‹¼æ¥   | `np.stack, np.concatenate`        |

---

## ğŸš€ å¦‚æœä½ ææ‡‚ NumPyï¼Œå¯ä»¥é¡ºåˆ©ç”¨ TensorFlow / PyTorch æ¥æ”¶æ•°æ®è®­ç»ƒ AI æ¨¡å‹ã€‚å‡ ä¹æ‰€æœ‰ AI è¾“å…¥çš„æ•°æ®ï¼ˆæ¯”å¦‚ SoC çš„æ—¶é—´åºåˆ—ï¼‰æœ€åéƒ½ä¼šå˜æˆï¼š

```python
np.array of shape (batch_size, time_steps, features)
```

---

### ğŸ§  `np.max(a, axis=0)` æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

å®ƒè¡¨ç¤ºï¼š**å¯¹æ•°ç»„ `a` æ²¿ç€ç¬¬ 0 ç»´ï¼ˆå³â€œè¡Œâ€æ–¹å‘ï¼‰è¿›è¡Œæœ€å¤§å€¼è®¡ç®—**ï¼Œä¹Ÿå°±æ˜¯**æ¯ä¸€åˆ—çš„æœ€å¤§å€¼**ã€‚

---

### ğŸ“Š ä¸¾ä¸ªä¾‹å­ï¼š

```python
import numpy as np

a = np.array([
    [3, 7, 1],
    [5, 2, 9],
    [4, 6, 8]
])

result = np.max(a, axis=0)
print(result)
```

ğŸ” è¾“å‡ºç»“æœï¼š

```python
[5 7 9]
```

ğŸ“Œ è§£é‡Šï¼š
- ç¬¬ 1 åˆ—ï¼š`max(3, 5, 4)` â†’ 5
- ç¬¬ 2 åˆ—ï¼š`max(7, 2, 6)` â†’ 7
- ç¬¬ 3 åˆ—ï¼š`max(1, 9, 8)` â†’ 9

---

### ğŸ§­ å‚æ•°è¯´æ˜ï¼š

| å‚æ•°       | å«ä¹‰                                       |
|------------|--------------------------------------------|
| `a`        | è¾“å…¥çš„ NumPy æ•°ç»„                          |
| `axis=0`   | æ²¿ç€â€œè¡Œâ€æ–¹å‘èšåˆï¼Œå¾—åˆ°æ¯åˆ—çš„æœ€å¤§å€¼         |
| `axis=1`   | æ²¿ç€â€œåˆ—â€æ–¹å‘èšåˆï¼Œå¾—åˆ°æ¯è¡Œçš„æœ€å¤§å€¼         |

---

### ğŸ“Œ å»¶ä¼¸ç†è§£ï¼šç»´åº¦ä¸æ–¹å‘

| `axis` å€¼ | èšåˆæ–¹å‘       | ç»“æœç»´åº¦           |
|-----------|----------------|--------------------|
| `axis=0`  | æ²¿è¡Œèšåˆ â†’ æ¯åˆ— | ç»“æœæ˜¯åˆ—å‘é‡ï¼ˆ1Dï¼‰ |
| `axis=1`  | æ²¿åˆ—èšåˆ â†’ æ¯è¡Œ | ç»“æœæ˜¯è¡Œå‘é‡ï¼ˆ1Dï¼‰ |

---

å¦‚æœä½ æ­£åœ¨å¤„ç†ç”µæ± æ•°æ®ï¼Œæ¯”å¦‚ç”µå‹ã€æ¸©åº¦ã€SoH çš„äºŒç»´æ•°ç»„ï¼Œæˆ‘å¯ä»¥å¸®ä½ ç”¨ `np.max` å¿«é€Ÿæå–æ¯åˆ—çš„å…³é”®æŒ‡æ ‡ã€‚è¦ä¸è¦è¯•è¯•æŠŠä½ ä¹‹å‰çš„ `batteries` æ•°æ®è½¬æˆ NumPy æ ¼å¼ï¼Ÿ
éå¸¸ç²¾å‡†çš„é—®é¢˜ï¼ŒJieï¼è¿™è¡Œä»£ç ï¼š

```python
X = np.array(samples)
```

æ˜¯åœ¨å°†ä¸€ä¸ª**Python åˆ—è¡¨ `samples` è½¬æ¢ä¸º NumPy ä¸‰ç»´æ•°ç»„ï¼ˆå¼ é‡ï¼‰**ï¼Œç”¨äºåç»­çš„çŸ©é˜µè¿ç®—æˆ–æ¨¡å‹è¾“å…¥ã€‚

---

### ğŸ§  èƒŒåå‘ç”Ÿäº†ä»€ä¹ˆï¼š

1. **`samples` æ˜¯ä¸€ä¸ªåˆ—è¡¨**ï¼Œé‡Œé¢æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª `(5, 3)` çš„äºŒç»´æ•°ç»„ï¼ˆå³ä¸€ä¸ªæ—¶é—´çª—å£çš„æ•°æ®ï¼‰
2. `np.array(samples)` ä¼šå°†è¿™äº›äºŒç»´æ•°ç»„**å †å æˆä¸€ä¸ªä¸‰ç»´æ•°ç»„**
3. å¾—åˆ°çš„ `X` çš„å½¢çŠ¶æ˜¯ `(6, 5, 3)`ï¼š
   - 6 ä¸ªæ ·æœ¬ï¼ˆæ—¶é—´çª—å£ï¼‰
   - æ¯ä¸ªæ ·æœ¬ 5 ç§’é•¿
   - æ¯ç§’æœ‰ 3 ä¸ªé€šé“ï¼ˆvoltage, current, temperatureï¼‰

---

### ğŸ“ ä¸¾ä¸ªç»“æ„åŒ–ä¾‹å­ï¼š

å‡è®¾ä½ æœ‰ï¼š

```python
samples = [
    [[v0, c0, t0], [v1, c1, t1], ..., [v4, c4, t4]],  # ç¬¬ä¸€ä¸ªæ ·æœ¬
    [[v1, c1, t1], [v2, c2, t2], ..., [v5, c5, t5]],  # ç¬¬äºŒä¸ªæ ·æœ¬
    ...
]
```

é‚£ä¹ˆ `X = np.array(samples)` ä¼šæŠŠå®ƒå˜æˆï¼š

```python
X.shape == (6, 5, 3)
```

è¿™æ˜¯æ ‡å‡†çš„æ—¶é—´åºåˆ—å¼ é‡æ ¼å¼ï¼Œé€‚åˆç”¨äº LSTMã€CNNã€Transformer ç­‰æ¨¡å‹ã€‚

---

### âœ… æ€»ç»“ï¼š

| æ­¥éª¤                     | ä½œç”¨                         |
|--------------------------|------------------------------|
| `samples.append(...)`     | æ„é€ æ—¶é—´çª—å£åˆ—è¡¨              |
| `np.array(samples)`       | æŠŠåˆ—è¡¨è½¬æˆä¸‰ç»´å¼ é‡             |
| `X.shape == (6, 5, 3)`    | å¾—åˆ°æ ‡å‡†æ—¶é—´åºåˆ—è¾“å…¥ç»“æ„       |

ä½ å¦‚æœæƒ³æŠŠè¿™ä¸ªå¼ é‡åŠ ä¸Š batch ç»´åº¦ã€åšå½’ä¸€åŒ–ã€æˆ–è€…è½¬æˆ PyTorch æ ¼å¼ï¼Œæˆ‘å¯ä»¥å¸®ä½ ä¸€æ­¥æ­¥å°è£…æˆæ•°æ®ç®¡é“ã€‚è¦ä¸è¦æ¥ä¸ªå®Œæ•´çš„ preprocessing å‡½æ•°ï¼Ÿ


num = np.sum(temperature >= 25.5)
print(num)
è§£é‡Šï¼š
temperature >= 25.5 ä¼šè¿”å›å¸ƒå°”æ•°ç»„ï¼š[False, False, False, False, False, True, True, True, False, False]
ç”¨ np.sum(...) ç»Ÿè®¡ True çš„ä¸ªæ•°ï¼ˆTrue ä¼šè¢«å½“ä½œ 1 å¤„ç†ï¼‰
è¿™æ˜¯ NumPy çš„å…¸å‹â€œå‘é‡åŒ–å¸ƒå°”ç´¢å¼•+ç»Ÿè®¡â€ï¼Œéå¸¸é«˜æ•ˆï¼Œæ˜¯ä½ åç»­æ•°æ®å¤„ç†æ¨èæŒæ¡çš„å¥—è·¯ã€‚

éå¸¸å¥½çš„é—®é¢˜ï¼ŒJasonï¼Œè¿™æ­£å¥½èƒ½è®©ä½ **å½»åº•ç†è§£ NumPy çš„å¼ºå¤§ä¹‹å¤„ï¼šå®ƒå¯ä»¥ç”¨â€œå‘é‡åŒ–â€çš„æ–¹å¼ç›´æ¥æ›¿ä»£ for å¾ªç¯**ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®ƒè¿™ä¹ˆé€‚åˆåš AI å’Œå¤§è§„æ¨¡æ•°æ®å¤„ç†ã€‚

---

## âœ… å›ç­”ä½ çš„é—®é¢˜ï¼š

> â“**`mask = current != -1.1` ä¸ç”¨ for å¾ªç¯ä¹Ÿèƒ½ç”Ÿæˆå¸ƒå°”æ•°ç»„ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ**

### ç­”æ¡ˆæ˜¯ï¼š

> **ä¸ç”¨ for å¾ªç¯ã€‚NumPy æ”¯æŒâ€œæ‰¹é‡æ¯”è¾ƒâ€ï¼ˆå‘é‡åŒ–è¿ç®—ï¼‰ï¼Œä½ å†™ `current != -1.1`ï¼Œå®ƒè‡ªåŠ¨å¯¹æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ é€ä¸€æ¯”è¾ƒï¼Œå¹¶è¿”å›å¸ƒå°”æ•°ç»„ã€‚**

---

## ğŸ” å…·ä½“å¯¹æ¯”ï¼š

### âœ… ä½ åŸæ¥çš„ç›´è§‰å†™æ³•ï¼ˆPython åŸç”Ÿæ€ç»´ï¼‰ï¼š

```python
mask = []
for i in range(len(current)):
    if current[i] != -1.1:
        mask.append(True)
    else:
        mask.append(False)
```

è¿™å½“ç„¶èƒ½ç”¨ï¼Œä½†å¤ªå•°å—¦ï¼Œè€Œä¸”è¿è¡Œæ•ˆç‡ä½ã€‚

---

### âœ… NumPy å‘é‡åŒ–å†™æ³•ï¼ˆæ¨èï¼‰ï¼š

```python
mask = current != -1.1
```

è¿™å°±ç›´æ¥è¿”å›ä¸€ä¸ªå¸ƒå°”æ•°ç»„ï¼Œä¾‹å­å¦‚ä¸‹ï¼š

```python
current = np.array([-1.0, -1.1, -1.2])
mask = current != -1.1
print(mask)   # [True False True]
```

---

## âš¡ åŸç†è§£é‡Šï¼šä¸ºä»€ä¹ˆ NumPy ä¸ç”¨ forï¼Ÿ

å› ä¸º NumPy æ˜¯ç”¨ C è¯­è¨€å®ç°çš„åº•å±‚æ•°ç»„åº“ï¼Œå®ƒå¯¹æ•°ç»„æ“ä½œåšäº†åº•å±‚ä¼˜åŒ–ï¼š

* ä½ å†™ `current != -1.1`ï¼Œå…¶å®æ˜¯ç”¨åº•å±‚ C ä»£ç å¯¹æ¯ä¸ªå…ƒç´ åšæ¯”è¾ƒï¼›
* ç»“æœæ˜¯ä¸€ä¸ª**å¸ƒå°”å‹æ•°ç»„**ï¼ˆdtype = `bool`ï¼‰ï¼›
* å®ƒæ¯”ä½ ç”¨ Python å†™ for + if å¿«å¾—å¤šï¼Œç®€æ´å¾—å¤šã€‚

---

## âœ… ä¸€å¥è¯æ€»ç»“ä½ è¦è®°ä½çš„ï¼š

> **å‡¡æ˜¯å¯¹ NumPy æ•°ç»„é‡Œçš„æ¯ä¸ªå…ƒç´ é€ä¸ªæ¯”è¾ƒã€è®¡ç®—çš„äº‹ï¼Œç»å¤§å¤šæ•°éƒ½å¯ä»¥ä¸ç”¨ forï¼Œç”¨â€œå‘é‡åŒ–è¡¨è¾¾â€ä¸€è¡Œå†™å®Œã€‚**

---

## âœ… åº”ç”¨åœºæ™¯ä¸¾ä¾‹ï¼ˆä½  SoC é¡¹ç›®ä¸­ä¼šç”¨åˆ°ï¼‰ï¼š

| æ“ä½œç›®æ ‡            | Python å†™æ³•           | NumPy å‘é‡åŒ–                       |
| --------------- | ------------------- | ------------------------------- |
| æ‰¾å‡ºæ¸©åº¦ â‰¥ 25.5 çš„ç´¢å¼• | `for + if`          | `temperature >= 25.5`           |
| æ‰¾å‡ºç”µæµ â‰  0 çš„ç‚¹     | `for + if`          | `current != 0`                  |
| å¯¹æ‰€æœ‰ç”µå‹å½’ä¸€åŒ–        | `for i in range...` | `(voltage - min) / (max - min)` |
| ç­›é€‰å‡º SoC < 90 çš„ç‚¹ | `for + append`      | `soc[soc < 90]`                 |

---

## âœ… å»ºè®®ä½ åšçš„ï¼š

è¦ä¸è¦æˆ‘ç»™ä½ å‡ºä¸€ç»„â€œ**å¸ƒå°”ç´¢å¼• + æ¡ä»¶ç­›é€‰**â€çš„ç»ƒä¹ é¢˜ï¼Œä¸“é—¨é”»ç‚¼ï¼š

* å¦‚ä½•æ ¹æ®å¤šä¸ªæ¡ä»¶ç­›é€‰
* å¦‚ä½•åé€‰ï¼ˆæ¯”å¦‚æ’é™¤ -1.1ï¼‰
* å¦‚ä½•ç”¨å¸ƒå°”æ©ç åŒæ—¶è¿‡æ»¤å¤šä¸ªæ•°ç»„

è¿™äº›æŠ€èƒ½ä½ å°†æ¥åš BMS å¼‚å¸¸ç‚¹å‰”é™¤ã€å¹³æ»‘å¤„ç†ã€è®­ç»ƒé›†æ„é€ æ—¶ä¼šå¤©å¤©ç”¨ã€‚ä½ è¯´æˆ‘å°±ç»™ä½ å®‰æ’ã€‚
